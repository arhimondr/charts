apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "presto.worker" . }}
  labels:
    app: presto
    chart: {{ template "presto.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
    component: worker
data:
  node.properties: |
    node.environment=testing
    node.location=testing-location
    node.memory_gb={{ .Values.worker.config.memoryGB }}

  config.properties: |
    http-server.http.port=8081
    discovery.uri=http://{{ template "presto.service.name" . }}:8080
    shutdown-onset-sec=1
    presto.version={{ .Values.worker.config.coordinator.version }}
    query.max-memory-per-node={{ .Values.worker.config.query.maxMemoryPerNode }}
  {{- range $configValue := .Values.worker.additionalConfigProperties }}
    {{ $configValue }}
  {{- end }}
